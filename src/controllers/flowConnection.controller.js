const flowConnectionService = require('../services/flowConnection.service');

exports.create = async (req, reply) => {
  try {
    const res = await flowConnectionService.createConnection(req.body);
    return reply.code(res.success ? 200 : 400).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.update = async (req, reply) => {
  try {
    const res = await flowConnectionService.updateConnection(req.params.id, req.body);
    return reply.code(res.success ? 200 : 400).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.delete = async (req, reply) => {
  try {
    const res = await flowConnectionService.deleteConnection(req.params.id);
    return reply.code(res.success ? 200 : 404).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.hardDelete = async (req, reply) => {
  try {
    const res = await flowConnectionService.hardDeleteConnection(req.params.id);
    return reply.code(res.success ? 200 : 404).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.getOne = async (req, reply) => {
  try {
    const res = await flowConnectionService.getConnectionById(req.params.id);
    return reply.code(res.success ? 200 : 404).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.getFlowConnections = async (req, reply) => {
  try {
    const res = await flowConnectionService.getFlowConnections(req.params.flowId);
    return reply.code(res.success ? 200 : 404).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.getNodeOutgoing = async (req, reply) => {
  try {
    const res = await flowConnectionService.getNodeOutgoingConnections(req.params.nodeId);
    return reply.code(res.success ? 200 : 404).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.getNodeIncoming = async (req, reply) => {
  try {
    const res = await flowConnectionService.getNodeIncomingConnections(req.params.nodeId);
    return reply.code(res.success ? 200 : 404).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.bulkCreate = async (req, reply) => {
  try {
    const res = await flowConnectionService.bulkCreateConnections(req.body);
    return reply.code(res.success ? 200 : 400).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.deleteFlowConnections = async (req, reply) => {
  try {
    const res = await flowConnectionService.deleteFlowConnections(req.params.flowId);
    return reply.code(res.success ? 200 : 404).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};

exports.replaceConnections = async (req, reply) => {
  try {
    const res = await flowConnectionService.replaceFlowConnections(req.body);
    return reply.code(res.success ? 200 : 400).send(res);
  } catch (err) {
    return reply.code(500).send({ success: false, message: err.message });
  }
};
